(function(t){function e(e){for(var o,s,i=e[0],c=e[1],l=e[2],g=0,d=[];g<i.length;g++)s=i[g],a[s]&&d.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(o=!1)}o&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},a={app:0},r=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("64a9"),a=n.n(o);a.a},"1f73":function(t,e,n){},"221c":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"run",function(){return run}),__webpack_require__.d(__webpack_exports__,"interpolate",function(){return interpolate});var core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__);function run(text){var ctx=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return text=text.replace(/\$(\w+\W?)/g," ctx.$1"),console.log("EVAL",text),eval(text)}function interpolate(t,e){return t.replace(/{{(.*?)}}/g,function(t,n){var o=run(n,e);return console.log("RESULT of interpolation",o),o})}},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Gra",{attrs:{msg:"Welcome to Your Vue.js App"}})],1)},r=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"status"},[n("div",{domProps:{innerHTML:t._s(t.statusText)}}),t.ctx.options?n("div",{staticClass:"option",attrs:{"data-option":"options"},on:{click:t.chooseOption}},[t._v("Options")]):t._e()]),t.dialog?n("div",{staticClass:"dialog"},[n("div",{staticClass:"intro",domProps:{innerHTML:t._s(t.dialog.intro.textInterpolated)}}),t._l(t.dialog.options,function(e,o){return n("div",{key:t.ctx.dialogName+"_"+o+" "+e.text.length,staticClass:"option",attrs:{"data-option":o,test:t.ctx.dialogName+"_"+o+" "+e.text.length},on:{click:t.chooseOption}},[t._v(t._s(e.textInterpolated))])})],2):t._e(),this.ctx.messages?n("log-messages",{attrs:{messages:t.ctx.messages}}):t._e(),n("input",{directives:[{name:"model",rawName:"v-model",value:t.debug,expression:"debug"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.debug)?t._i(t.debug,null)>-1:t.debug},on:{change:function(e){var n=t.debug,o=e.target,a=!!o.checked;if(Array.isArray(n)){var r=null,s=t._i(n,r);o.checked?s<0&&(t.debug=n.concat([r])):s>-1&&(t.debug=n.slice(0,s).concat(n.slice(s+1)))}else t.debug=a}}}),t.debug?n("debug",{attrs:{ctx:t.ctx}}):t._e()],1)},i=[],c=(n("4917"),n("768b")),l=(n("ac6a"),n("28a5"),n("7514"),n("221c"));function u(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function o(t){return t?l["run"](t,n):void 0}console.log("DATA",t);var a=t.find(function(t){return t.id==e});if(a){o(a.run);var r=a.intro.find(function(t){return!t.if||l["run"](t.if,n)});r.textInterpolated=l["interpolate"](r.text,n).split("^nl").join("<br>"),console.log("TI",r.textInterpolated),o(r.run);var s=[];return a.options.forEach(function(t){if(t.each){var e=t.each.match(/^\((.*)\) in (.*)/),o=Object(c["a"])(e,3),a=(o[0],o[1]),r=o[2],i=a.split(/\s?,\s?/),u=Object(c["a"])(i,2),g=u[0],d=u[1];console.log("FIRST",a),console.log("x".concat(g,"x x").concat(d,"x")),console.log("ARR",r);var f=l["run"](r,n);console.log("ARRR",f),f.forEach(function(e,o){var a=JSON.parse(JSON.stringify(t));n[g]=e,n[d]=o,a.textInterpolated=l["interpolate"](a.text,n).split("^nl").join("<br>");var r="$"+g+"="+JSON.stringify(e)+"; $"+d+"="+JSON.stringify(o)+";";a.run&&(a.run=r+a.run),a.if&&(a.if=r+a.if),console.log("NO",a),s.push(a)})}else t.textInterpolated=l["interpolate"](t.text,n).split("^nl").join("<br>"),s.push(t)}),s=s.filter(function(t){return!t.if||l["run"](t.if,n)}),{intro:r,options:s}}}function g(t,e){return t.run&&(console.log("OPTION to run",t.run),l["run"](t.run,e)),!t.go||"exit"!=t.go&&t.go}console.log("SCREEPT",l);var d={processDialog:u,hello:function(){console.log("Hello.")},processOptionChoice:g,screept:l},f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h2",[t._v("Debug")]),n("h1",{staticClass:"dialogName"},[t._v("Dialog: "+t._s(t.ctx.dialogName)+" Turn: "+t._s(t.ctx.turn))]),n("h1",[t._v("Stack")]),n("div",{staticClass:"stack flex-wrapped"},t._l(t.ctx.stack,function(e,o){return n("div",{key:e+o},[t._v(t._s(e))])}),0),n("h1",[t._v("Flags")]),n("div",{staticClass:"flags flex-wrapped"},t._l(t.ctx.flags,function(e,o){return n("div",{key:o,class:{flagOn:e}},[t._v(t._s(o)+"("+t._s(e)+")")])}),0),n("h1",[t._v("Inventory")]),n("div",{staticClass:"inventory flex-wrapped"},t._l(t.ctx.inventory,function(e,o){return n("div",{key:o,class:{flagOn:e}},[t._v(t._s(o)+"("+t._s(e)+")")])}),0),n("h1",[t._v("Stats")]),n("div",{staticClass:"stats flex-wrapped"},t._l(t.ctx.stats,function(e,o){return n("div",{key:o},[t._v(t._s(o)+"("+t._s(e)+")")])}),0)])},_=[],p={name:"Debug",props:["ctx"]},h=p,m=(n("fa7e"),n("2877")),$=Object(m["a"])(h,f,_,!1,null,"77f9bd40",null),x=$.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"box log-messages-div"},[n("header",[n("span",{staticClass:"log-messages-header-text"},[t._v("Messages")]),n("button",{on:{click:function(e){return t.handleArrow(1)}}},[t._v("↑")]),n("button",{on:{click:function(e){return t.handleArrow(-1)}}},[t._v("↓")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.expanded,expression:"expanded"}],staticClass:"expanded-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.expanded)?t._i(t.expanded,null)>-1:t.expanded},on:{change:function(e){var n=t.expanded,o=e.target,a=!!o.checked;if(Array.isArray(n)){var r=null,s=t._i(n,r);o.checked?s<0&&(t.expanded=n.concat([r])):s>-1&&(t.expanded=n.slice(0,s).concat(n.slice(s+1)))}else t.expanded=a}}})]),t._l(t.messageList,function(e){return n("p",{key:e.id,staticClass:"log-message-p",class:"log-class-"+e.type},[n("span",{staticClass:"log-messages-turn"},[t._v(t._s(e.turn)+":")]),n("span",{staticClass:"log-messages-text"},[t._v(" "+t._s(e.text))])])})],2)},b=[],T={name:"LogMessages",props:{messages:Array},data:function(){return{expanded:!1,showCount:5,expandedCount:8,offset:0}},methods:{handleArrow:function(t){this.offset+=t,this.offset<0&&(this.offset=0),this.offset>this.messages.length-this.count&&(this.offset=this.messages.length-this.count)}},computed:{count:function(){return this.expanded?this.expandedCount:this.showCount},messageList:function(){return this.offset?this.messages.slice(-(this.count+this.offset),-this.offset):this.messages.slice(-this.count)}}},y=T,N=(n("d0d5"),Object(m["a"])(y,v,b,!1,null,null,null)),k=N.exports,R=[{id:"options",intro:[{text:"Options. You have {{$INVENTORY()}}"}],options:[{text:"msg",run:"$MSG('test 1');$MSG('test 2');$MSG('test 3');$MSG('test 4');$MSG('test 5');$MSG('test 6');$MSG('test 7');$MSG('test 8');$MSG('test 9');$MSG('test 10');$MSG('test 11');"},{text:"Craft",go:"craft"},{text:"Cook",run:"$crafting_station='kitchen'",go:"craft"},{text:"Fight",run:"$opponent=$npc.find($FINDER('name','goblin'));$COMBAT_PREPARE()",go:"combat"},{text:"Look at yourself.",go:"look-at-self"},{text:"Eat",go:"eat"},{text:"Eat a meal {{$INV('widget')}}",if:"$INV('meal') > 0 & $stats.energy < 100; ",run:"$INV('meal',-1); $INV('widget',2)"},{text:"Rest an hour",if:"$stats.energy < 100",run:"$TURN(4); $STAT('energy',10)"},{text:"Wait an hour",run:"$TURN(4)"},{text:"Sleep until morning",run:"$flags.sleeping=1;$WAIT_UNTIL_MORNING();$flags.sleeping=0;$stats.energy=$stats.energy_max*1.2",go:"return"},{text:"Save Game",run:"$SAVE()"},{text:"Load Game",run:"$LOAD()"},{text:"* Grow Plants *",run:"$PLANTS_GROW()"},{text:"Back",go:"return"}]},{id:"message",intro:[{text:"{{$message}}"}],options:[{text:"OK",run:"$message=''",go:"return"}]},{id:"eat",intro:[{text:"What do you want to eat?"}],run:"$DEBUG('TYPE',$TYPE('cabbage'))",options:[{each:"(v,k) in Object.entries($inventory).filter( (va)=>va[1] && $TYPE(va[0]) && $TYPE(va[0]).foodValue)",text:"{{$v[0]}} (you have {{$v[1]}})",run:"$STAT('energy',$TYPE($v[0]).foodValue);$INV($v[0],-1);$TURN(1)"},{text:"Nothing",go:"return"}]},{id:"craft",intro:[{text:"Craft {{$crafting_station||''}}"}],options:[{each:"(v,k) in $recipes",if:"( ($v.workstation || $crafting_station) ?$crafting_station==$v.workstation : true ) && $v.ing.every(ing=>$INV(ing[0])>=ing[1])",text:"{{$v.name}}",run:"$CRAFT($v.name)"},{text:"Nothing",run:"$crafting_station=''",go:"return"}]},{id:"farm",intro:[{text:"Your farm has {{$farm.length}} plots. Growing {{$farm.map($PLANT_STATUS).join(', ')}}"}],options:[{text:"Plant",if:"$farm.find(plot=>!plot.plant)",go:"plant"},{text:"Harvest",if:"$farm.find($FINDER('stage',10))",go:"harvest"},{text:"Grow",run:"$PLANTS_GROW()"},{text:"Back",go:"return"}]},{id:"plant",intro:[{text:"Currently planting {{$planting}} and you have {{$INV($planting)}}",if:"$planting"},{text:"No seeds chosen."}],options:[{text:"Change seeds",go:"choose_planting"},{each:"(v,k) in  $farm",if:"!$v.plant && $INV($planting)",text:"Plant {{$planting}}",run:"$DEBUG($k);$DEBUG($v); \n              $PLANT($k,$planting); $TIRE(1); $TURN(1);$INV($planting,-1)"},{text:"Back",go:"return"}]},{id:"choose_planting",intro:[{text:"Currently planting {{$planting}} and you have {{$INV($planting)}} ",if:"$planting"},{text:"No seeds chosen."}],options:[{text:"Nothing.",run:"$planting=null"},{each:"(v,k) in Object.keys($inventory).filter(item=>item.includes('_seed'))",text:"You have {{$INV($v)}} of {{$v}}",run:"$planting=$v",go:"return"},{text:"Back",go:"return"}]},{id:"trade",run:"$trader=$npc.find($FINDER('name',$traderName));$DEBUG('tRa',$ITEM_TYPES($trader.sells))",intro:[{text:"Hello my name is {{$trader.name}} and I'd like to trade!"}],options:[{each:"(v,k) in $ITEM_TYPES($trader.sells)",if:"$INV('money')>=$TYPE($v).price",text:"Buy 1 {{$v}} for {{$TYPE($v).price}} .",run:"$INV($v,1);$INV('money',-$TYPE($v).price)"},{each:"(v,k) in $ITEM_TYPES($trader.buys)",if:"$INV($v)",text:"Sell 1 {{$v}} for {{$TYPE($v).price}}",run:"$INV($v,-1);$INV('money',$TYPE($v).price)"},{text:"Back",go:"return"}]},{id:"combat",run:"$DEBUG($opponent);$options=false;$DEBUG($options)",intro:[{text:"{{$message}} The fight is over!",if:"$combat_won||$combat_lost",run:"$message=''"},{text:"{{$message}}You are fighting with {{$opponent.name}} that has {{$opponent.stats.energy}} energy",run:"$message=''"}],options:[{text:"Attack!",if:"!$COMBAT_IS_FINISHED()",run:"$COMBAT_ROUND()"},{text:"Flee!",if:"!$COMBAT_IS_FINISHED()",go:"combat_flee"},{text:"Great!",if:"$combat_won",run:"$combat_won=false;$combat_lost=false;$options=true",go:"return"},{text:"Oh well...",if:"$combat_lost",run:"$combat_won=false;$combat_lost=false;$options=true",go:"return"}]},{id:"combat_flee",run:"$COMBAT_TRY_FLEE()",intro:[{text:"You try to flee. {{$message}}  ",run:"$message=''"}],options:[{text:"OK",go:"return"}]},{id:"harvest",intro:[{text:"What you want to harvest?"}],options:[{each:"(v,k) in $farm",if:"$v.stage===10",text:"Harvest {{$v.plant}}",run:"$DEBUG($k);$HARVEST($k);$TIRE(2);$TURN(1)"},{text:"Back",go:"return"}]},{id:"start",intro:[{text:'You wake up on the side of a road. Your head hurts and you don\'t remember anything. \n                {{$flags.looked_around ? "The road seems to lead to some village, you have a feeling that the other way is trouble." : "" }}'}],options:[{text:"Look around.",if:" !$flags.looked_around ",run:"$flags.looked_around++ ; $TURN(1)"},{text:"Go towards the village",if:"$flags.looked_around",go:"village",run:"$TURN(2)"}]},{id:"look-at-self",run:"$TURN(1)",intro:[{text:'You look {{ $stats.energy > 40 ?  "rested" : "tired"}}, no obvious damage. {{$flags.dirty ? "You are dirty." : "" }}'}],options:[{text:"Back",go:"return"}]},{id:"village",intro:[{text:'You are in the village. {{$IS_DAY()?"There are some people around." : "Everyone gone inside for the night"}}'}],options:[{text:'Talk to {{!$flags.met_bernie ? "an elderly man" : "Bernie"}} sitting on a bench on the green',go:"talk_bernie",if:"!$flags.bartender_favor_bernie_finished"},{text:"Go to the pond.",go:"pond"},{text:"Go to the inn.",go:"inn"},{text:"Go to the shop.",run:"$traderName='Zach'",go:"trade"},{text:"Go to your farm.",go:"farm"},{text:"Go to the forest",run:"$TURN(1);$TIRE(1)",go:"forest"},{text:"Go to the caves",run:"$TURN(1);$TIRE(1)",go:"caves"}]},{id:"talk_bernie",run:"$flags.met_bernie++",intro:[{text:'"Hello again. How is it going? What can I do for you?" said Bernie',if:"$flags.met_bernie > 1"},{text:'"Hi there. My name is Bernie. What can I do for you" said elderly man.'}],options:[{text:"Can you tell me what is this place?",go:"bernie_what_is_this_place"},{text:"The bartender says he is sorry and would like to go the the inn for a meal",if:"$flags.bartender_favor_bernie_asked  & !$flags.bartender_favor_bernie_finished",go:"bernie_agrees"},{text:"Nothing, I'm leaving",go:"return"}]},{id:"bernie_agrees",intro:[{text:'"Ok. Free meal? I guess I can forgive him. Let\'s go!"'}],options:[{text:"OK.",go:"task_bartender_favor_bernie_finished"}]},{id:"bernie_what_is_this_place",run:"$flags.citaa_remembered=1",intro:[{text:"'It's just a simple village.' we are the last stop before the sea port town of Oppa.\n                 People usually go there if they need to get to Citaa, the capital'. You just remembered! You need to get to Citaa!"}],options:[{text:"I just remembered! I need to to Citaa! How can I get there?",go:"bernie_how_citaa"},{text:"Thanks.",go:"return"}]},{id:"bernie_how_citaa",intro:[{text:"Well, the ships to Citaa leave every 12 days, and you can catch a carriage to Oppa every afternoon, the bartender knows the current price."}],options:[{text:"Thanks",go:"return"}]},{id:"pond",intro:[{text:"You find yourself by a pond."}],options:[{text:"Wash yourself.",if:"$flags.dirty",run:"$TURN(2);$flags.dirty=0"},{text:"Try to fish",go:"fishing"},{text:"Back to village",go:"village"}]},{id:"fishing",run:"$TURN(2); $catch = $TEST_ROLL(50) ? 1 : 0; $INV('fish',$catch); $TIRE(2)",intro:[{text:"You caught a fish!",if:"$catch"},{text:"Sorry, no bonus"}],options:[{text:"Back",go:"return"}]},{id:"inn",intro:[{text:"You are in a small inn. There is a bartender at the bar."}],options:[{text:"Talk to the bartender",go:"bartender_talk"},{text:"Talk to Bernie",go:"talk_bernie",if:"$flags.bartender_favor_bernie_finished"},{text:"Trade",run:"$traderName='Bartender'",go:"trade"},{text:"Back to village",go:"village"}]},{id:"bartender_talk",intro:[{text:"What can I do for you?",if:"$flags.talked_to_bartender"},{text:'"Hello there. Who are you stranger?"'}],options:[{text:"I don't remember.",run:"$flags.talked_to_bartender=1",if:"!$flags.talked_to_bartender"},{text:"Thats's not your business! Bye.",go:"return",run:"$flags.talked_to_bartender=1",if:"!$flags.talked_to_bartender"},{text:"How can I earn some money?",if:"$flags.talked_to_bartender",go:"bartender_money"},{text:"I would like to buy something.",if:"$flags.talked_to_bartender",go:"bartender_sells"},{text:"All I remember is need to get to Citaa.",if:"$flags.citaa_remembered",run:"$flags.talked_to_bartender=1",go:"bartender_talk_citaa"},{text:"Nothing",go:"return",if:"$flags.talked_to_bartender"}]},{id:"bartender_talk_citaa",intro:[{text:'"I hope you have a lot of money. The ship fare costs 100 coins."',if:"$flags.talked_to_bartender"}],options:[{text:"I understand.",go:"return"}]},{id:"bartender_money",run:"$flags.bartender_favor_bernie_asked=1",intro:[{text:'"I always can buy fish from you.{{!$flags.bartender_favor_bernie_finished ? "Go and tell Bernie I\'m sorry, ask him to come here and you both will get free meal." : ""  }}"'}],options:[{text:"Sell 1 fish",if:"$INV('fish') > 0",run:"$INV('fish',-1);$INV('money',3)"},{text:"I understand.",go:"return"}]},{id:"bartender_sells",intro:[{text:'"I have meals for 5 gold."'}],options:[{text:"Buy 1 meal",if:"$INV('money') > 4",run:"$INV('money',-5);$INV('meal',1)"},{text:"Thanks.",go:"return"}]},{run:"$flags.bartender_favor_bernie_finished=1; $INV('meal',1)",id:"task_bartender_favor_bernie_finished",intro:[{text:'You both went to the inn. The Bartender says "Thanks for that! Meals for you!" and gives you a nice hot meal.'}],options:[{text:"Thanks.",go:"inn"}]},{id:"forest",run:"$TEST_ROLL(($depth+1)*10)?$COMBAT_START('goblin'):false",intro:[{text:"You are at the {{$depth}}. You are being attacked by {{$opponent.name}}",if:"$combat_forced"},{text:"You are at the {{$depth}}."}],options:[{text:"Go deeper",run:"$depth++;$TURN(1);$TIRE(1)",if:"!$combat_forced",go:"forest"},{text:"Forage",run:"$FORAGE();",if:"!$combat_forced",go:"message"},{text:"Go back to the village",run:"$TURN(1);$TIRE(1)",if:"!$depth && !$combat_forced",go:"village"},{text:"Go back a bit",if:"$depth && !$combat_forced",run:"$depth--;$TURN(1);$TIRE(1)",go:"forest"},{text:"Fight!",if:"$combat_forced",run:"$combat_forced=false",go:"combat"}]},{id:"caves",intro:[{text:"You are at the {{$depth}} of the caves."}],options:[{text:"Go deeper",run:"$depth++",go:"caves"},{text:"Mine",run:"$MINE()",go:"message"},{text:"Go back to the village",if:"!$depth",go:"village"},{text:"Go back a bit",if:"$depth",run:"$depth--",go:"caves"}]}],E=[{name:"axe",ing:[["stone",2],["stick",3]]},{name:"widget",ing:[["stick",1]]},{name:"cooked_fish",ing:[["fish",1]],workstation:"kitchen"}],I=(n("a481"),n("a8db"));n("3846"),n("c5f6"),n("ffc1"),n("4f7f"),n("5df3"),n("1c4c"),n("7f7f"),n("6762"),n("2fdb"),n("f559"),n("456d");function O(t,e){Object.keys(A).filter(function(t){return t===t.toUpperCase()}).forEach(function(n){t[n]=function(){for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return A[n].apply(A,[t,e].concat(a))}})}var A={WAIT_UNTIL_MORNING:function(t,e){while(t.turn%(24*e.TURNS_PER_HOUR)!==6*e.TURNS_PER_HOUR)this.nextTurn(t,e)},FINDER:function(t,e,n,o){return function(t){return t[n]===o}},MSG:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info",a={turn:t.turn,id:t.messageId++,text:n,type:o};t.messages=t.messages.concat(a)},ITEM_TYPES:function(t,e,n){var o=n.map(function(e){return e.startsWith("tag:")?t.types.filter(function(t){return t.tags&&t.tags.includes(e.slice(4))}).map(function(t){return t.name}):e}).flat(),a=Array.from(new Set(o));return a},TYPE:function(t,e,n){return t.types.find(this.FINDER(t,e,"name",n))},TURN:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=0;o<n;o++)this.nextTurn(t,e)},GET_HOUR:function(t,e){return(t.turn/e.TURNS_PER_HOUR>>0)%24},GET_DAY:function(t,e){return 1+t.turn/e.TURNS_PER_HOUR/24>>0},IS_DAY:function(t,e){var n=(t.turn/e.TURNS_PER_HOUR>>0)%24;return n>5&&n<20},TIRE:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.STAT(t,e,"energy",-n)},DEBUG:function(t,e){for(var n,o=arguments.length,a=new Array(o>2?o-2:0),r=2;r<o;r++)a[r-2]=arguments[r];(n=console).log.apply(n,["DEBUG:"].concat(a))},STACK_POP:function(t,e){t.stack=t.stack.slice(0,t.stack.slice.length-1)},STAT:function(t,e,n,o,a){a=a||t;var r=a.stats;r[n]+=o,r[n]>r[n+"_max"]&&(r[n]=r[n+"_max"]),r[n]<0&&(r[n]=0)},INVENTORY:function(t,e){return Object.entries(t.inventory).filter(function(t){return t[1]}).map(function(t){return t[0]+":"+t[1]}).join(", ")},INV:function(t,e,n,o){var a=t.inventory;if(!o)return a[n]||0;var r=a[n]||0;a[n]=r+Number(o),a[n]<0&&(a[n]=0)},TEST_ROLL:function(t,e,n){return 100*Math.random()<n},RND:function(t,e,n){return Math.random()*n>>0},nextTurn:function(t,e){console.log("Turn passed, new turn ",++t.turn),t.turn%(24*e.TURNS_PER_HOUR)===6*e.TURNS_PER_HOUR&&this.PLANTS_GROW(t,e),t.turn%(24*e.TURNS_PER_HOUR)===22*e.TURNS_PER_HOUR&&(console.log("Pass out!"),t.flags.sleeping||t.flags.passedOut||this.MSG("You passed out, it was too late!"),this.WAIT_UNTIL_MORNING(t,e),this.MSG("You woke up in the morning."))},SAVE:function(t,e){t.recipes,t.types;var n=Object(I["a"])(t,["recipes","types"]);console.log(n),localStorage.setItem("save",JSON.stringify(n))},LOAD:function(t,e){var n=JSON.parse(localStorage.getItem("save"));Object.keys(n).forEach(function(e){t[e]=n[e]})},PLANTS_GROW:function(t,e){t.farm.forEach(function(e){e.plant&&(e.stage+=t.TYPE(e.plant).grow,e.stage>10&&(e.stage=10))})},PLANT:function(t,e,n,o){var a=o.replace(/_seed/,""),r=t.farm[n];r.plant=a,r.stage=0},PLANT_STATUS:function(t,e,n){return n.plant?"".concat(n.plant," (").concat(n.stage,"/10)"):"- empty -"},HARVEST:function(t,e,n){var o=t.farm[n];this.INV(t,e,o.plant,1),o.plant="",o.stage=0},MINE:function(t,e){var n=Math.random()*(t.depth+2)>>0;this.TURN(t,e,4),this.TIRE(t,e,10),t.message="You found ".concat(n," stones."),this.INV(t,e,"stone",n)},FORAGE:function(t,e){var n=Math.random()*(t.depth+2)>>0;this.TURN(t,e,4),this.TIRE(t,e,4),t.message="You found ".concat(n," sticks."),this.INV(t,e,"stick",n)},CRAFT:function(t,e,n){var o=this,a=t.recipes.find(this.FINDER(t,e,"name",n));a.ing.forEach(function(n){var a=Object(c["a"])(n,2),r=a[0],s=a[1];console.log("C",r,s),o.INV(t,e,r,-s)}),this.INV(t,e,n,1),this.TURN(t,e,1)},TRADER_ITEMS:function(t,e){return t.types.filter(function(e){return t.trader.sells.some(function(t){return t===e.name||t.startsWith("tag:")&&e.tags&&e.tags.includes(t.slice(4))})}).map(function(t){return t.name})},COMBAT_START:function(t,e){t.opponent=t.npc.find(finder("name","goblin")),t.combat_forced=!0,this.COMBAT_PREPARE(t,CFG)},COMBAT_PREPARE:function(t,e){var n=t.opponent;n.generic&&(n.stats.energy=n.stats.energy_max)},COMBAT_IS_FINISHED:function(t,e){return t.combat_won||t.combat_lost||t.stats.energy<1||t.opponent.stats.energy<1},COMBAT_ATTACK:function(t,e){var n=this.RND(t,e,10);this.TIRE(t,e,1),this.STAT(t,e,"energy",-n,t.opponent),t.message="You hit ".concat(t.opponent.name," for ").concat(n," damage. "),this.MSG(t,e,"You hit ".concat(t.opponent.name," for ").concat(n," damage. "),"combat")},COMBAT_NPC_ATTACK:function(t,e){if(t.opponent.stats.energy>0){var n=this.RND(t,e,10);this.STAT(t,e,"energy",-n),t.message+=" You are hit for ".concat(n," damage. "),this.MSG(t,e," You are hit for ".concat(n," damage. "),"combat")}},COMBAT_STATE:function(t,e){t.opponent.stats.energy<1?(t.message+=" You defeated ".concat(t.opponent.name,"!"),t.combat_won=!0):t.stats.energy<1&&(t.message+=" You have been defeated! ",t.flags.passedOut=1,this.MSG(t,e," You have been defeated! "),this.MSG(t,e,"You have passed out for some time..."),t.combat_lost=!0,this.TURN(t,e,8*e.TURNS_PER_HOUR),t.flags.passedOut=0,t.stats.energy=t.stats.energy_max/2>>0)},COMBAT_ROUND:function(t,e){this.COMBAT_ATTACK(t,e),this.TEST_ROLL(t,e,10)&&t.TURN(t,e,1),this.COMBAT_NPC_ATTACK(t,e),this.COMBAT_STATE(t,e)},COMBAT_TRY_FLEE:function(t,e){var n=t.RND(t,e,10);n<4?(t.message+="You managed to escape. ",this.STACK_POP(t,e),console.log("Success")):n<8?(t.message+="You managed to escape, but... ",this.COMBAT_NPC_ATTACK(t,e),console.log("Success kinda"),this.STACK_POP(t,e)):(t.message+="You didn't manage to escape. ",this.COMBAT_NPC_ATTACK(t,e),console.log("Fail!"))}},S=[{name:"cabbage",foodValue:10,grow:2,price:5,tags:["produce","test"]},{name:"cabbage_seed",price:7},{name:"radish_seed",price:1,tags:["test"]},{name:"radish",foodValue:5,grow:3,price:3,tags:["produce"]},{name:"meal",foodValue:30,price:10},{name:"fish",foodValue:20,price:8}],w=(n("7ab5"),{dialogName:"village",options:!0,message:"",messages:[],messageId:0,stack:[],other:{met:-1},depth:0,turn:25,inventory:{money:20,sword:0,fish:1,meal:2,cabbage_seed:2,radish_seed:1,cabbage:3,stick:5,stone:10},npc:[{name:"Zach",sells:["cabbage_seed","radish_seed"],buys:["tag:produce","fish"]},{name:"Bartender",sells:["meal"],buys:["fish","cabbage"]},{name:"goblin",generic:!0,stats:{energy:50,energy_max:50,attack:120,defence:75}}],planting:"cabbage_seed",farm:[{plant:"cabbage",stage:8},{plant:""}],stats:{energy:60,energy_max:100},flags:{dirty:1,passedOut:0,sleeping:0,looked_around:0,met_bernie:0,talked_to_bartender:0,bartender_favor_bernie_finished:0,bartender_favor_bernie_asked:0,citaa_remembered:0}}),C={};function P(){var t='\n  Time is {{$GET_HOUR()}} o\'clock. It\'s {{$GET_DAY()}} {{ $IS_DAY() ?"day": "night"}}.\n  You have {{$inventory.money}} coins. Energy: {{$stats.energy}} ^nl\n \n  ',e=l["interpolate"](t,w).split("^nl").join("<br>");return e}function U(){console.log("INIT RUN"),w.types=S,w.recipes=E,O(w,C,U),console.log("TTT",w.TYPE("cabbage"),Array.isArray(w.types),w.FINDER("name","cabbage"))}C.TURNS_PER_HOUR=4;var M={dialogs:R,status:P,ctx:w,init:U},G={name:"Gra",props:{msg:String},components:{Debug:x,LogMessages:k},data:function(){return{debug:!0,ctx:{},status:null,dialogs:null}},computed:{dialog:function(){return this.ctx.dialogName?(console.log("dialog liczony",this.ctx.dialogName),d.processDialog(this.dialogs,this.ctx.dialogName,this.ctx)):null},context:function(){return console.log("Context liczony"),JSON.stringify(this.ctx)},statusText:function(){if(console.log("Status liczony"),JSON.stringify(this.ctx)&&this.status)return this.status()}},methods:{chooseOption:function(t){var e,n=t.target.dataset.option;e="options"===n?"options":d.processOptionChoice(this.dialog.options[n],this.ctx),console.log("RESULT IS",e),"return"===e?this.ctx.dialogName=this.ctx.stack.pop():e?"string"==typeof e?(e!==this.ctx.stack[this.ctx.stack.length-1]&&this.ctx.stack.push(this.ctx.dialogName),this.ctx.dialogName=e):!0===e&&console.log("RUN RUN RUN",this.ctx.farm):this.ctx.dialogName=null,console.log("CHOOSE OPTION",n,e,"STACK",this.ctx.stack.join(","))}},mounted:function(){this.dialogs=M.dialogs,this.status=M.status,this.ctx=M.ctx,M.init()}},Y=G,B=(n("db64"),Object(m["a"])(Y,s,i,!1,null,null,null)),D=B.exports,V={name:"app",components:{Gra:D}},L=V,j=(n("034f"),Object(m["a"])(L,a,r,!1,null,null,null)),H=j.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(t){return t(H)}}).$mount("#app")},"64a9":function(t,e,n){},"9bf6":function(t,e,n){},a236:function(t,e,n){},d0d5:function(t,e,n){"use strict";var o=n("9bf6"),a=n.n(o);a.a},db64:function(t,e,n){"use strict";var o=n("a236"),a=n.n(o);a.a},fa7e:function(t,e,n){"use strict";var o=n("1f73"),a=n.n(o);a.a}});
//# sourceMappingURL=app.1f510671.js.map